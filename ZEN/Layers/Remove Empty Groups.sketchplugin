// Remove empty groups (command e)

var doc = context.document;
var artboard = [[doc currentPage] currentArtboard];
var root = artboard.children();

function deleteEmptyGroups(root) {
  var len = root.length();
  for (var i=0; i<len; i++) {
    if (root[i].class() == "MSLayerGroup" && root[i].layers().length() === 0) {
      root[i].parentGroup().removeLayer(root[i]);
    }
  }
}

deleteEmptyGroups(root);
